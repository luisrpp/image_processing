<!doctype html>
<html lang="pt-br">
    <head>
        <meta charset="utf-8">

        <title>Processamento de Imagens em Ruby</title>

        <meta name="description" content="Introdução ao Processamento de Imagens utilizando a linguagem Ruby">
        <meta name="author" content="Luis Roberto Pereira de Paula">

        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

        <link rel="stylesheet" href="css/reveal.css">
        <link rel="stylesheet" href="css/theme/black.css" id="theme">

        <!-- Theme used for syntax highlighting of code -->
        <link rel="stylesheet" href="lib/css/zenburn.css">

        <!-- Printing and PDF exports -->
        <script>
            var link = document.createElement( 'link' );
            link.rel = 'stylesheet';
            link.type = 'text/css';
            link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
            document.getElementsByTagName( 'head' )[0].appendChild( link );
        </script>

        <!--[if lt IE 9]>
            <script src="lib/js/html5shiv.js"></script>
        <![endif]-->
    </head>
    <body>
        <div class="reveal">
            <div class="slides">
                <section data-transition="none">
                    <h1>Processamento de Imagens em <font color="#f08">Ruby</font></h1>
                    <p>
                        <small>Por <a href="http://github.com/luisrpp">Luis Roberto P. Paula</a> / <a href="http://twitter.com/luisrpp">@luisrpp</a></small>
                    </p>
                </section>

                <section data-transition="none">
                    <h2><font color="#0af">Fundamentos</font></h2>
                </section>

                <section data-transition="none">
                    <h3><font color="#0af">Imagens Digitais</font></h3>

                    <p style="text-align: left">São definidas por uma função bidimensional de intensidade da luz $f(x, y)$, onde:</p>
                    <ul>
                        <li>$(x, y)$ denotam as coordenadas espaciais</li>
                        <li>o valor de $f$ em qualquer ponto $(x, y)$ é proporcional ao brilho da imagem naquele ponto</li>
                    </ul>

                    <p style="text-align: left">Os pontos de uma imagem são denominados <b><i>pixels</i></b>.</p>
                </section>

                <section data-transition="none">
                    <h4>Convenção dos eixos para representação de imagens digitais</h4>

                    <div style="float: left">
                        <img style="border: none;" height="420" data-src="images/digital_image.png">
                    </div>

                    <div style="float: right; text-align: left; font-size: 25px">
                        <p>Propriedades:</p>
                        <ul>
                            <li><b>Largura:</b> 640px</li>
                            <li><b>Altura:</b> 480px</li>
                            <li><b>Exemplo:</b> $f(366, 188) = 248$</li>
                        </ul>
                    </div>
                </section>

                <section data-transition="none" style="text-align: left">
                    <h4>Fatores que afetam a qualidade da imagem</h4>

                    <ul>
                        <li>Quantização</li>
                        <li>Resolução espacial</li>
                    </ul>
                </section>

                <section data-transition="none">
                    <h5>Quantização - número de níveis de cinza</h5>

                    <div style="float: left">
                        <table style="font-size: 32px">
                            <thead>
                                <tr>
                                    <th>Precisão</th>
                                    <th>Mínimo</th>
                                    <th>Máximo</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>$2^{1}$</td>
                                    <td>0</td>
                                    <td>1</td>
                                </tr>
                                <tr>
                                    <td>$2^{2}$</td>
                                    <td>0</td>
                                    <td>3</td>
                                </tr>
                                <tr>
                                    <td>$2^{3}$</td>
                                    <td>0</td>
                                    <td>7</td>
                                </tr>
                                <tr>
                                    <td>$2^{4}$</td>
                                    <td>0</td>
                                    <td>15</td>
                                </tr>
                                <tr>
                                    <td>$2^{5}$</td>
                                    <td>0</td>
                                    <td>31</td>
                                </tr>
                                <tr>
                                    <td>$2^{6}$</td>
                                    <td>0</td>
                                    <td>63</td>
                                </tr>
                                <tr>
                                    <td>$2^{7}$</td>
                                    <td>0</td>
                                    <td>127</td>
                                </tr>
                                <tr>
                                    <td>$2^{8}$</td>
                                    <td>0</td>
                                    <td>255</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div style="float: right">
                        <img style="border: none" width="480" data-src="images/grey_level.png">
                    </div>
                </section>

                <section data-transition="none">
                    <div>
                        <img src="images/lena_quantization.png">
                    </div>

                    <aside class="notes">
                        <ul>
                            <li>Playboy de Novembro de 1972</li>
                            <li>Utilizada em pesquisa sobre compressão de imagens</li>
                            <li>Ideal para diversos testes em processamento de imagens</li>
                            <li>Convidada para 50a edição do Imaging Science and Technology</li>
                        </ul>
                    </aside>
                </section>

                <section data-transition="none">
                    <h5>Resolução Espacial</h5>

                    <div>
                        <img style="border: none" data-src="images/spatial_resolution.png">
                    </div>
                </section>

                <section data-transition="none" data-background="images/lincoln_pixel_values.png">
                    <aside class="notes">
                        <ul>
                            <li>Ref: <a href="http://openframeworks.cc/ofBook/chapters/image_processing_computer_vision.html" target="bank">openFrameworks</a></li>
                        </ul>
                    </aside>
                </section>

                <section data-transition="none">
                    <h5>Imagens Coloridas</h5>

                    <ul>
                        <li><font color="red">R</font><font color="green">G</font><font color="blue">B</font> é o formato mais comum</li>
                        <li>
                            Cada pixel possui 3 valores, um para cada canal
                            <ul>
                                <li>Exemplo: $f(x, y) = [255, 50, 33]$</li>
                            </ul>
                        <li>
                            Outros formatos:
                            <ul>
                                <li>YCbCr</li>
                                <li>HSV</li>
                            </ul>
                        </li>
                    </ul>

                    <aside class="notes">
                        <ul>
                            <li>O RGB mimetiza o funcionamento do olho humano para a constituição da cor.</li>
                        </ul>
                    </aside>
                </section>

                <section data-transition="none">
                    <h5>Exemplo de uma matriz RGB</h5>

                    <div>
                        <img style="border: none" data-src="images/rgb.png">
                    </div>
                </section>

                <section data-transition="none">
                    <h3><font color="#0af">Processamento de Imagens Digitais</font></h3>

                    <p class="fragment">São operações realizadas em imagens digitais.</p>
                </section>

                <section data-transition="none">
                    <h4>Áreas de aplicação</h4>

                    <ul>
                        <li>Facilitar a interpretação de imagens por pessoas</li>
                        <li>Permitir o armazenamento, transmissão e representação de informação visual para percepção por máquinas</li>
                    </ul>
                </section>

                <section data-transition="none">
                    <h4>Primeiras aplicações</h4>

                    <img style="border: none" data-src="images/historical_01.jpg">

                    <p>Melhoramento de imagens digitalizadas para jornais, enviadas por cabo submarino, de Londres para Nova York, no início da década de 1920.</p>

                    <aside class="notes">
                        <ul>
                            <li>Sistema Bartlane de transmissão de imagens</li>
                            <li>Redução do tempo de mais de uma semana para menos de 3 horas</li>
                            <li>Imagem em cinco níveis de cinza</li>
                            <li>Dados decodificados eram enviados para uma impressora telegráfica</li>
                        <ul>
                    </aside>
                </section>

                <section data-transition="none">
                    <h4>Melhorias no Processo</h4>

                    <div>
                        <img style="border: none" data-src="images/historical_02.jpg">
                        <img style="border: none" data-src="images/historical_03.jpg">
                    </div>

                    <p>
                        No final da mesma década, em 1929, o número de níveis de cinza das imagens foram aumentados de 5 para 15.
                    </p>

                    <aside class="notes">
                        <ul>
                            <li>Melhorias no processo de impressão e distribuição do brilho</li>
                        <ul>
                    </aside>
                </section>

                <section data-transition="none">
                    <p>Melhorias nos métodos de processamento para transmissão de imagens continuaram a ser feitos ao longo dos 35 anos
                    que seguiram...</p>
                </section>

                <section data-transition="none">
                    <div style="float: left; width: 50%;">
                        <img height="400" style="border: none" data-src="images/moon.jpg">
                    </div>

                    <div style="float: right; width: 50%;">
                        <p style="font-size: 37px; text-align: left;">
                            Até que a combinação do surgimento dos <font color="#0af"><b>computadores digitais de grande porte</b></font> com o
                            <font color="#0af"><b>programa espacial</b></font> chamam a atenção para o potencial dos conceitos de processamento de imagem.
                        </p>
                    </div>

                    <aside class="notes">
                        <ul>
                            <li>Imagem de 31 de Julho de 1964</li>
                            <li>Transmitida pelo Ranger 7</li>
                            <li>Foto tirada 17 minutos antes da chegada à superficie da Lua</li>
                        </ul>
                    </aside>
                </section>

                <section data-transition="none">
                    <h4>Exemplos</h4>
                </section>

                <section data-transition="none">
                    <h4>Redução de ruído</h4>
                    <div>
                        <img style="border: none" data-src="images/noise_reduction.jpg">
                    </div>
                </section>

                <section data-transition="none">
                    <h4>Detecção de faces</h4>
                    <div>
                        <img style="border: none" data-src="images/face-detection.png">
                    </div>
                </section>

                <section data-transition="none">
                    <h4>Detecção automática de placas de veículos</h4>
                    <div>
                        <img style="border: none" data-src="images/plate.jpg">
                    </div>
                </section>

                <section data-transition="none">
                    <h4>Segmentação de tumores cerebrais</h4>
                    <div>
                        <img style="border: none" data-src="images/brain.png">
                    </div>
                </section>

                <section data-transition="none">
                    <section data-transition="none">
                        <h4>Passos fundamentais</h4>

                        <div>
                            <img style="border: none" data-src="images/image_processing_steps.png">
                        </div>
                    </section>

                    <section data-transition="none">
                        <h4>Passos fundamentais</h4>

                        <div>
                            <img style="border: none" data-src="images/image_processing_steps_1.png">
                        </div>
                    </section>

                    <section data-transition="none">
                        <h4>Aquisição de Imagens</h4>

                        <ul style="font-size: 37px;">
                            <li>Pela utilização de um sensor de imageamento e a capacidade de digitalizar o
                                sinal produzido pelo sensor</li>
                            <li>Pode ser a câmera de um smartphone, por exemplo</li>
                        </ul>
                    </section>

                    <section data-transition="none">
                        <h4>Passos fundamentais</h4>

                        <div>
                            <img style="border: none" data-src="images/image_processing_steps_2.png">
                        </div>
                    </section>

                    <section data-transition="none">
                        <h4>Pré-processamento</h4>

                        <ul style="font-size: 37px;">
                            <li>Melhorar a imagem de forma a aumentar as chances de sucesso das etapas
                                seguintes</li>
                            <li>Aplicação de realce de contrastes, remoção de ruído, isolamento de regiões,
                                dentre outras técnicas</li>
                        </ul>
                    </section>

                    <section data-transition="none">
                        <h4>Passos fundamentais</h4>

                        <div>
                            <img style="border: none" data-src="images/image_processing_steps_3.png">
                        </div>
                    </section>

                    <section data-transition="none">
                        <h4>Segmentação</h4>

                        <ul style="font-size: 37px;">
                            <li>Divide a imagem de entrada em partes. Por exemplo: objetos de interesse
                                e o fundo da imagem</li>
                            <li>A segmentação automática é uma das tarefas mais difíceis no processamento
                                de imagens digitais</li>
                        </ul>
                    </section>

                    <section data-transition="none">
                        <h4>Passos fundamentais</h4>

                        <div>
                            <img style="border: none" data-src="images/image_processing_steps_4.png">
                        </div>
                    </section>

                    <section data-transition="none">
                        <h4>Representação e descrição</h4>

                        <ul style="font-size: 37px;">
                            <li>A representação apenas transforma os dados iniciais em uma forma adequada
                                para processamento posterior</li>
                            <li>A descrição procura enfatizar as características de interesse</li>
                            <li>Exemplo: presença de buracos e concavidades em problemas
                                de detecção de caracteres</li>
                        </ul>
                    </section>

                    <section data-transition="none">
                        <h4>Passos fundamentais</h4>

                        <div>
                            <img style="border: none" data-src="images/image_processing_steps_5.png">
                        </div>
                    </section>

                    <section data-transition="none">
                        <h4>Reconhecimento e interpretação</h4>

                        <ul style="font-size: 37px;">
                            <li>O reconhecimento é o processo que atribui um rótulo a um objeto</li>
                            <li>A interpretação atribui um significado a um conjunto de objetos reconhecidos</li>
                            <li>Exemplo: a identificação de caracteres, e se este conjunto corresponde ou não
                                à placa de um veículo</li>
                        </ul>
                    </section>

                    <section data-transition="none">
                        <h4>Passos fundamentais</h4>

                        <div>
                            <img style="border: none" data-src="images/image_processing_steps_6.png">
                        </div>
                    </section>

                    <section data-transition="none">
                        <h4>Base de conhecimento</h4>

                        <ul style="font-size: 37px;">
                            <li>É a codificação do conhecimento sobre o domínio do problema</li>
                            <li>Pode efetar qualquer módulo de processamento</li>
                            <li>Controla a interação entre os módulos</li>
                        </ul>
                    </section>
                </section>

                <section data-transition="none">
                    <h2><font color="#0af">Bibliotecas</font></h2>
                </section>

                <section data-transition="none">
                    <h3><a href="https://opencv.org/">OpenCV</a></h3>

                    <ul style="font-size: 37px;">
                        <li>Open Source Computer Vision Library</li>
                        <li>Desenvolvida originalmente pela Intel</li>
                        <li>Interfaces para <i>C</i>, <i>C++</i>, <i>Python</i> e <i>Java</i></li>
                        <li>Wrappers para outras linguagens, como <i>Ruby</i>, <i>.Net</i>, <i>Go</i></li>
                        <li>Cross-platform (incluindo Android e iOS)</li>
                    </ul>
                </section>

                <section data-transition="none">
                    <h3><a href="https://itk.org/">ITK</a></h3>

                    <ul style="font-size: 37px;">
                        <li>Insight Segmentation and Registration Toolkit</li>
                        <li>Open-source</li>
                        <li>Desenvolvido em <i>C++</i>, com wrappers para outras linguagens</li>
                        <li>Comum para segmentação de imagens médicas</li>
                        <li>Suporte para imagens multidimensionais</li>
                    </ul>
                </section>

                <section data-transition="none">
                    <h3><a href="https://www.imagemagick.org">ImageMagick</a></h3>

                    <ul style="font-size: 37px;">
                        <li>Utilizada para criar, editar, compor ou converter imagens bitmap</li>
                        <li>Tipicamente utilizada via linha de comando</li>
                        <li>
                            Bindings para diversas linguagens:
                            <ul>
                                <li>Ruby (<a href="https://rmagick.github.io/">RMagick</a>, <a href="https://github.com/minimagick/minimagick">MiniMagick</a>)</li>
                                <li>Python (<a href="https://www.imagemagick.org/download/python/">PythonMagick</a>)</li>
                                <li>Go (<a href="https://github.com/gographics/imagick">Go Imagick</a>)</li>
                                <li>Java (<a href="http://www.jmagick.org/">JMagick</a>)</li>
                                <li>e muitas <a href="http://www.imagemagick.org/script/develop.php">outras</a></li>
                            </ul>
                        </li>
                    </ul>
                </section>

                <section data-transition="none">
                    <h3><a href="http://jcupitt.github.io/libvips">VIPS (libvips)</a></h3>

                    <ul style="font-size: 37px;">
                        <li>Biblioteca para processamento de imagens 2D</li>
                        <li>Baixo consumo de memória e rápida, especialmente em máquinas com mais de uma CPU</li>
                        <li>Thread-safe (operações em imagens geram novas imagens)</li>
                        <li>APIs para <i>C</i> e <i>C++</i>, com bindings para <i>Python</i>, <i>Ruby</i>, <i>PHP</i>, <i>GO</i>, <i>Lua</i> e linha de comando</li>
                    </ul>
                </section>

                <section data-transition="none">
                    <section data-transition="none">
                        <h2><font color="#0af">Ruby-Vips</font></h2>

                        <p>
                            Utilizaremos o binding para <font color="#f08">Ruby</font> da <a href="https://github.com/jcupitt/ruby-vips">libvips</a>.
                        </p>
                    </section>

                    <section data-transition="none">
                        <h3>Carregando uma Imagem</h3>

                        <pre><code class="ruby" data-trim contenteditable>
                        require 'vips'

                        # A partir de um arquivo
                        image = Vips::Image.new_from_file('my_image.png')

                        # A partir de um array
                        image = Vips::Image.new_from_array([[50.0, 60.0, 70.0],
                                                            [100.0, 150.0, 190.0],
                                                            [200.0, 220.0, 255.0]])
                        </code></pre>
                    </section>

                    <section data-transition="none">
                        <h3>Propriedades da Imagem</h3>

                        <pre><code class="ruby" data-trim contenteditable>
                        image.filename # ./samples/my_image.jpg

                        image.size # [512, 512]
                        image.width  # 512
                        image.height # 512

                        image.bands # 3

                        image.interpretation # #&lt;Vips::Interpretation srgb&gt;
                        image.format # #&lt;Vips::BandFormat uchar&gt;

                        image.min # 0.0
                        image.max # 246.0
                        </code></pre>
                    </section>

                    <section data-transition="none">
                        <h3>Operações básicas</h3>

                        <div style="float: left; width: 50%">
                            <pre><code class="ruby" data-trim contenteditable>
                            # Adição
                            image + 10

                            # Subtração
                            image - 10

                            # Multiplicação
                            image * 0

                            # Divisão
                            image / 255
                            </code></pre>
                        </div>

                        <div style="float: right; width: 50%">
                            <pre><code class="ruby" data-trim contenteditable>
                            # Adição
                            image1 + image2

                            # Subtração
                            image1 - image2

                            # Multiplicação
                            image1 * image2

                            # Divisão
                            image1 / image2
                            </code></pre>
                        </div>
                    </section>

                    <section data-transition="none">
                        <h3>Salvando a Imagem</h3>

                        <pre><code class="ruby" data-trim contenteditable>
                        # Salva a imagem em um arquivo
                        image.write_to_file '/tmp/my_image.png'

                        # Escreve a imagem em um buffer de memória
                        buffer = image.write_to_buffer ".jpg[Q=90]"
                        </code></pre>
                    </section>
                </section>

                <section data-transition="none">
                    <h2><font color="#0af">O Problema</font></h2>

                    <p>Como estudo de caso, iremos desenvolver uma solução para detecção de retas em
                        imagens.</p>
                </section>

                <section data-transition="none">
                    <h3>Quantas retas possui esta imagem?</h3>

                    <div>
                        <img style="border: none" height="450" data-src="images/building.jpg">
                    </div>
                </section>

                <section data-transition="none">
                    <h3>E esta outra?</h3>

                    <div>
                        <img style="border: none" height="450" data-src="images/chessboard.png">
                    </div>
                </section>

                <section data-transition="none">
                    <h3>Motivação</h3>

                    <p>Identificar formas em imagens pode nos ajudar na detecção de objetos de interesse.</p>
                </section>

                <section data-transition="none">
                    <h3><font color="#0af">Passos para o processamento</font></h3>

                    <ol style="font-size: 37px;">
                        <li class="fragment">Aquisição: uma imagem digital qualquer fornecida</li>
                        <li class="fragment">Pré-processamento
                            <ul>
                                <li class="fragment">Converter a imagem para níveis de cinza</li>
                                <li class="fragment">Evidenciar bordas</li>
                                <li class="fragment">Thresholding</li>
                            </ul>
                        </li>
                        <li class="fragment">Segmentação: Detectar retas na imagem</li>
                        <li class="fragment">Representação: Parâmetros das retas encontradas</li>
                        <li class="fragment">Interpretação: Estamos interessados em todas as retas encontradas?</li>
                        <li class="fragment">Resultado: Retas desenhadas na imagem original</li>
                    </ol>
                </section>

                <section data-transition="none">
                    <h2><font color="#0af">Pré-Processamento</font></h2>
                </section>

                <section data-transition="none">
                    <h3><font color="#0af">Conversão para níveis de cinza</font></h3>

                    <pre><code class="ruby" data-trim contenteditable>
                    module Vips
                      class Image
                        # Converts the image to greyscale.
                        #
                        # @return [Vips::Image] greyscale image
                        def to_greyscale
                          if format == :uchar
                            colourspace(:b_w)[0] # 8-bit source
                          else
                            colourspace(:grey16)[0]
                          end
                        end
                      end
                    end
                    </code></pre>
                </section>

                <section data-transition="none">
                    <div style="float: left; width: 50%">
                        <img style="border: none" height="450" data-src="images/masp.JPG">
                    </div>

                    <div style="float: right; width: 50%">
                        <img style="border: none" height="450" data-src="images/masp_bw.JPG">
                    </div>
                </section>

                <section data-transition="none">
                    <h3><font color="#0af">Evidenciar bordas</font></h3>

                    <ul style="font-size: 37px;">
                        <li>Existem alguns algoritmos para tratar esse problema. Alguns conhecidos são o
                            <i><font color="#0af">Canny edge detector</font></i> e o <i><font color="#0af">Sobel operator</font></i></li>
                        <li>Nesta apresentação, utilizaremos o <b><font color="#0af">Gradiente Morfológico</font></b></li>
                    </ul>
                </section>

                <section data-transition="none">
                    <p>Para entendermos o <b><font color="#0af">Gradiente Morfológico</font></b>, precisamos antes
                        de alguns conceitos sobre <b><font color="#0af">Morfologia Matemática</font></b>.</p>
                </section>

                <section data-transition="none">
                    <h3><font color="#0af">Morfologia Matemática</font></h3>

                    <ul style="font-size: 37px;">
                        <li class="fragment">MM é uma teoria e técnica para a análise e processamento de estruturas geométricas</li>
                        <li class="fragment">Utiliza conceitos da álgebra (teoria dos conjuntos, reticulados completos) e geometria
                            (translação, distância e convexidade)</li>
                        <li class="fragment">Os operadores morfológicos básicos são: dilatação e erosão</li>
                    </ul>
                </section>

                <section data-transition="none">
                    <h3><font color="#0af">Dilatação</font></h3>

                    <ul style="font-size: 37px;">
                        <li class="fragment">Conhecida como uma operação de crescimento, expansão ou preenchimento de regiões</li>
                        <li class="fragment">Inicialmente somente em imagens binárias, com adaptações posteriores para imagens em níveis de cinza</li>
                        <li class="fragment">Algumas características:
                            <ul>
                                <li>Tamanho dos objetos são aumentados</li>
                                <li>Pequenos buracos são eliminados</li>
                                <li>Número de componentes pode diminuir</li>
                            </ul>
                        </li>
                    </ul>
                </section>

                <section data-transition="none">
                    <p>A <b>Dilatação</b> recebe como parâmetros uma
                        <span class="fragment highlight-blue visible">imagem de entrada</span> e um
                        <span class="fragment highlight-red visible">elemento estruturante</span>.</p>
                </section>

                <section data-transition="none">
                    <h4><font color="#0af">Elemento Estruturante</font></h4>

                    <div style="float: left; width: 65%">
                        <ul style="font-size: 37px;">
                            <li>Pode possuir qualquer forma ou tamanho, mas geralmente são utilizados quadrados
                                ou círculos</li>
                            <li>Também é definido um ponto de ancoragem, geralmente no centro</li>
                        </ul>
                    </div>

                    <div style="float: left; width: 35%">
                        <img style="border: none" height="215" data-src="images/ee.jpg">
                    </div>
                </section>

                <section data-transition="none">
                    <h4><font color="#0af">Algoritmo</font></h4>

                    <ul style="font-size: 37px;">
                        <li>Utilizamos um elemento estruturante $E$ para percorrer a imagem, posicionando
                            o ponto de ancoragem sobre cada pixel da imagem de entrada</li>
                        <li>Substituímos o valor deste pixel pelo valor do maior pixel contido na região coberta por
                            $E$</li>
                    </ul>
                </section>

                <section data-transition="none">
                    <div style="float: left; width: 50%">
                        <img style="border: none" data-src="images/dilation_bin_01.png">
                        <p>Imagem Original</p>
                    </div>

                    <div style="float: right; width: 50%" class="fragment">
                        <img style="border: none" height="150" data-src="images/dilation_ee.png">
                        <p style="font-size: 30px">Elemento Estruturante</p>
                    </div>
                </section>

                <section data-transition="none">
                    <div>
                        <img style="border: none" data-src="images/dilation_bin_02.png">
                        <p style="font-size: 30px">Ponto de ancoragem no primeiro pixel da imagem</p>
                    </div>
                </section>

                <section data-transition="none">
                    <div>
                        <img style="border: none" data-src="images/dilation_bin_03.png">
                        <p style="font-size: 30px">Ponto de ancoragem no pixel $[1, 1]$</p>
                    </div>
                </section>

                <section data-transition="none">
                    <div>
                        <img style="border: none" data-src="images/dilation_bin_04.png">
                        <p style="font-size: 30px">Resultado da dilatação</p>
                    </div>
                </section>

                <section data-transition="none">
                    <h4><font color="#0af">Dilatação no Ruby-Vips</font></h4>

                    <div>
                        <img style="border: none" data-src="images/ruby_vips_dilate.png">
                        <p class="fragment" style="font-size: 30px"><font color=#ff3">Somente para <b>imagens binárias</b></font></p>
                    </div>
                </section>

                <section data-transition="none">
                    <h4><font color="#0af">Dilatação para imagens em níveis de cinza</font></h4>

                    <p style="font-size: 30px">Implementação utilizando Rank Filter</p>

                    <pre><code class="ruby" data-trim contenteditable>
                    # Dilation on greyscale images, implemented
                    # as maximum filter.
                    #
                    # @param image [Vips::Image] greyscale image
                    # @param size_w [Integer] the width of the window
                    # @param size_h [Integer] the height of the window
                    #
                    # @return [Vips::Image] dilated image
                    def dilate(image, size_w = 3, size_h = size_w)
                      image.rank(size_w, size_h, size_w * size_h - 1)
                    end
                    </code></pre>
                </section>

                <section data-transition="none">
                    <h3><font color="#0af">Erosão</font></h3>

                    <ul style="font-size: 37px;">
                        <li class="fragment">Ao contrário da dilatação, a <b>Erosão</b> é uma operação que diminui o tamanho dos objetos presentes na imagem.</li>
                        <li class="fragment">Outras características:
                            <ul>
                                <li>Objetos menores que o elemento estruturante são eliminados</li>
                                <li>Número de componentes pode aumentar</li>
                            </ul>
                        </li>
                    </ul>
                </section>

                <section data-transition="none">
                    <h4><font color="#0af">Algoritmo</font></h4>

                    <ul style="font-size: 37px;">
                        <li>Utilizamos um elemento estruturante $E$ para percorrer a imagem, posicionando
                            o ponto de ancoragem sobre cada pixel da imagem de entrada</li>
                        <li>Substituímos o valor deste pixel pelo valor do menor pixel contido na região coberta por
                            $E$</li>
                    </ul>
                </section>

                <section data-transition="none">
                    <div style="float: left; width: 50%">
                        <img style="border: none" data-src="images/erosion_bin_01.png">
                        <p>Imagem Original</p>
                    </div>

                    <div style="float: right; width: 50%" class="fragment">
                        <img style="border: none" height="150" data-src="images/dilation_ee.png">
                        <p style="font-size: 30px">Elemento Estruturante</p>
                    </div>
                </section>

                <section data-transition="none">
                    <div>
                        <img style="border: none" data-src="images/erosion_bin_02.png">
                        <p style="font-size: 30px">Ponto de ancoragem no primeiro pixel da imagem</p>
                    </div>
                </section>

                <section data-transition="none">
                    <div>
                        <img style="border: none" data-src="images/erosion_bin_03.png">
                        <p style="font-size: 30px">Ponto de ancoragem no pixel $[1, 1]$</p>
                    </div>
                </section>

                <section data-transition="none">
                    <div>
                        <img style="border: none" data-src="images/erosion_bin_04.png">
                        <p style="font-size: 30px">Ponto de ancoragem no pixel $[2, 2]$</p>
                    </div>
                </section>

                <section data-transition="none">
                    <div>
                        <img style="border: none" data-src="images/erosion_bin_05.png">
                        <p style="font-size: 30px">Resultado da erosão</p>
                    </div>
                </section>

                <section data-transition="none">
                    <h4><font color="#0af">Erosão no Ruby-Vips</font></h4>

                    <div>
                        <img style="border: none" data-src="images/ruby_vips_erode.png">
                        <p class="fragment" style="font-size: 30px"><font color=#ff3">Também somente para <b>imagens binárias</b></font></p>
                    </div>
                </section>

                <section data-transition="none">
                    <h4><font color="#0af">Erosão para imagens em níveis de cinza</font></h4>

                    <p style="font-size: 30px">Implementação utilizando Rank Filter</p>

                    <pre><code class="ruby" data-trim contenteditable>
                    # Erode on greyscale images, implemented as minimum filter.
                    #
                    # @param image [Vips::Image] greyscale image
                    # @param size_w [Integer] the width of the window
                    # @param size_h [Integer] the height of the window
                    #
                    # @return [Vips::Image] eroded image
                    def erode(image, size_w = 3, size_h = size_w)
                      image.rank(size_w, size_h, 0)
                    end
                    </code></pre>
                </section>

                <section data-transition="none">
                    <h3><font color="#0af">Gradiente Morfológico</font></h3>

                    <ul style="font-size: 37px;">
                        <li>Operador utilizado para realçar as diferenças de intensidade de pixels em uma
                            dada vizinhança</li>
                        <li>Trata-se da diferença entre a dilatação e a erosão de uma imagem</li>
                    </ul>
                </section>

                <section data-transition="none">
                    <h4><font color="#0af">Implementação do Gradiente Morfológico</font></h4>

                    <pre><code class="ruby" data-trim contenteditable>
                    # Morphological gradient.
                    #
                    # @param image [Vips::Image] greyscale image
                    # @param size_w [Integer] the width of the window
                    # @param size_h [Integer] the height of the window
                    #
                    # @return [Vips::Image] the morphological gradient
                    def gradient(image, size_w = 3, size_h = size_w)
                      dilate(image, size_w, size_h)
                        .subtract(erode(image, size_w, size_h))
                    end
                    </code></pre>
                </section>

                <section data-transition="none">
                    <div style="float: left; width: 25%">
                        <div>
                            <p style="font-size: 25px">Imagem Original</p>
                            <img style="border: none" height="230" data-src="images/original_example.jpe">
                        </div>
                    </div>
                    <div class="fragment" style="float: left; width: 25%">
                        <div>
                            <p style="font-size: 25px">Dilatação</p>
                            <img style="border: none" height="230" data-src="images/dilate_example.jpe">
                        </div>
                    </div>
                    <div class="fragment" style="float: left; width: 25%">
                        <div>
                            <p style="font-size: 25px">Erosão</p>
                            <img style="border: none" height="230" data-src="images/erode_example.jpe">
                        </div>
                    </div>
                    <div class="fragment" style="float: left; width: 25%">
                        <div>
                            <p style="font-size: 25px">Gradiente</p>
                            <img style="border: none" height="230" data-src="images/morphological_gradient.jpe">
                        </div>
                    </div>
                </section>

                <section data-transition="none">
                    <p>A aplicação do gradiente morfológico em imagens em níveis de cinza pode gerar alguns ruídos.
                        Podemos eliminá-los utilizando um <font color="#0af">Threshold Simples</font>.</p>
                </section>

                <section data-transition="none">
                    <h3><font color="#0af">Thresholding</font></h3>

                    <ul style="font-size: 37px;">
                        <li>Definimos um limiar, de acordo com algumas características da imagem. Exemplo:
                            50% do valor do pixel de maior intensidade</li>
                        <li>Pixels acima do limiar são convertidos para branco (1 ou 255, dependendo da precisão)
                            <li>Pixels abaixo do limiar são convertidos para preto (0)</li>
                        <li>O resultado é uma imagem binária</li>
                    </ul>
                </section>

                <section data-transition="none">
                    <h4><font color="#0af">Thresholding no Ruby-Vips</font></h4>

                    <pre><code class="ruby" data-trim contenteditable>
                    # Definindo o valor do limiar
                    limiar = image.max / 2

                    # Threshold simples
                    threshold_img = image > limiar
                    </code></pre>
                </section>

                <section data-transition="none">
                    <div style="float: left; width: 50%">
                        <div>
                            <p style="font-size: 25px">Imagem Original</p>
                            <img style="border: none" data-src="images/apple_original.jpg">
                        </div>
                    </div>
                    <div style="float: left; width: 50%">
                        <div>
                            <p style="font-size: 25px">Threshold ($max / 5$)</p>
                            <img style="border: none" data-src="images/apple_threshold.jpe">
                        </div>
                    </div>
                </section>

                <section data-transition="none">
                    <div style="float: left; width: 50%">
                        <div>
                            <p style="font-size: 25px">Gradiente Morfológico</p>
                            <img style="border: none" data-src="images/apple_gradient.jpe">
                        </div>
                    </div>
                    <div style="float: left; width: 50%">
                        <div>
                            <p style="font-size: 25px">Threshold ($max / 5$)</p>
                            <img style="border: none" data-src="images/apple_gradient_thrs.jpe">
                        </div>
                    </div>
                </section>

                <section data-transition="none">
                    <h2><font color="#0af">Detecção de Retas em Imagens</font></h2>
                </section>

                <section data-transition="none">
                    <h3><font color="#0af">Transformada de Hough</font></h3>

                    <ul style="font-size: 37px;">
                        <li class="fragment">Técnica utilizada para encontrar linhas em imagens</li>
                        <li class="fragment">Pode ser generalizada para encontrar outras formas geométricas, como círculos
                            e elípses</li>
                    </ul>
                </section>

                <section data-transition="none">
                    <p>Para apresentar a <font color="#0af">Transformada de Hough</font>, é preciso definir o conceito
                        de espaço parametrizado.</p>
                </section>

                <section data-transition="none">
                    <p style="text-align: left">Dada a equação da reta:</p>

                    <center>$y = ax + b$</center>

                    <p style="text-align: left">temos <i>x-y</i> como sistema de coordenadas do plano da imagem.</p>
                </section>

                <section data-transition="none">
                    <div>
                        <p style="font-size: 37px">Plano da Imagem</p>
                        <img style="border: none" height="500" data-src="images/hough_xy.svg">
                    </div>
                </section>

                <section data-transition="none">
                    <p style="text-align: left">A equação da reta pode ser reescrita da seguinte forma:</p>

                    <center>$b = -xa + y$ </center>

                    <p style="text-align: left">tendo assim um novo sistema de coordenadas <i>a-b</i>.</p>

                    <p class="fragment" style="text-align: left">O sistema de coordenadas <i>a-b</i> representa o espaço parametrizado.</p>
                </section>

                <section data-transition="none">
                    <div style="float: left; width: 50%">
                        <p style="font-size: 37px">Plano da Imagem</p>
                        <img style="border: none" data-src="images/hough_xy.svg">
                    </div>
                    <div class="fragment" style="float: left; width: 50%">
                        <p style="font-size: 37px">Espaço Parametrizado</p>
                        <img style="border: none" data-src="images/hough_ab.png">
                    </div>
                </section>

                <section data-transition="none">
                    <p>Vamos agora considerar um conjunto de retas que passa pelo ponto $(6, 5)$ no plano da imagem.</p>
                </section>

                <section data-transition="none">
                    <div style="float: left; width: 50%">
                        <p style="font-size: 37px">Plano da Imagem</p>
                        <img style="border: none" data-src="images/plano_imagem_01.png">
                    </div>
                    <div class="fragment" style="float: left; width: 50%">
                        <p style="font-size: 37px">Espaço Parametrizado</p>
                        <img style="border: none" data-src="images/espaco_parametrizado_01.svg">
                    </div>
                </section>

                <section data-transition="none">
                    <p>Podemos representar todas as retas que passam por um ponto no Plano da Imagem
                        por apenas uma reta no Espaço Parametrizado.</p>
                </section>

                <section data-transition="none">
                    <p>Agora, vamos considerar dois pontos no Plano da Imagem. Esses pontos são:
                        $(4, 5)$ e $(8, 6)$.</p>
                </section>

                <section data-transition="none">
                    <div style="float: left; width: 50%">
                        <p style="font-size: 37px">Plano da Imagem</p>
                        <img style="border: none" data-src="images/plano_imagem_02.png">
                    </div>
                    <div class="fragment" style="float: left; width: 50%">
                        <p style="font-size: 37px">Espaço Parametrizado</p>
                        <img style="border: none" data-src="images/espaco_parametrizado_02.svg">
                    </div>
                </section>

                <section data-transition="none">
                    <p>A intersecção de retas no espaço parametrizado nos dá os parâmetros das retas
                        que passam pelos pontos do plano da imagem.</p>
                </section>

                <section data-transition="none">
                    <div>
                        <p style="font-size: 37px">Plano da Imagem</p>
                        <img style="border: none" height="500" data-src="images/plano_imagem_03.png">
                    </div>
                </section>

                <section data-transition="none">
                    <h3><font color="#0af">Algoritmo</font></h3>

                    <ol style="font-size: 37px;">
                        <li class="fragment">Inicializar uma matriz acumuladora com todos os valores zerados (essa matriz representa
                            o espaço parametrizado)</li>
                        <li class="fragment">Para cada pixel diferente de zero da imagem:
                            <ul>
                                <li>Registrar sua reta correspondente no espaço parametrizado, somando $+1$ na
                                    matriz acumuladora, nos pontos em que a reta passa</li>
                            </ul>
                        </li>
                        <li class="fragment">Os pontos de maior intensidade na matriz acumuladora indicam os parâmetros das
                            retas encontradas na imagem</li>
                    </ol>
                </section>

                <section data-transition="none">
                    <p>Mas...</p>

                    <p class="fragment">Existe um problema computacional relacionado ao registro de intersecções
                        na matriz acumuladora.</p>

                    <p class="fragment">Como registar a intersecção de retas paralelas ou que se encontram próximas
                        ao infinito?</p>
                </section>

                <section data-transition="none">
                    <h3><font color="#0af">Representação normal da reta</font></h3>

                    <div style="float: left; width: 60%">
                        <p style="text-align: left">Podemos utilizar coordenadas polares para a representação de retas:</p>

                        <center>$x.cos\theta + y.sen\theta = \rho$</center>
                    </div>

                    <div style="float: right; width: 40%">
                        <img style="border: none" height="300" data-src="images/line_normal_form.png">
                    </div>
                </section>

                <section data-transition="none">
                    <h3><font color="#0af">Espaço parametrizado</font></h3>

                    <ul>
                        <li>Os parâmetros $a$-$b$, da representação anterior, são então substituídos pelos parâmetros $\theta$ e $\rho$</li>
                        <li>Todas as retas que passam por um ponto no plano da imagem, passam a ser representados por uma senoide no espaço parametrizado</li>
                    </ul>
                </section>


                <section data-transition="none">
                    <div style="float: left; width: 50%">
                        <p style="font-size: 37px">Plano da Imagem</p>
                        <img style="border: none" data-src="images/hough_param_01.png">
                    </div>

                    <div class="fragment" style="float: left; width: 50%">
                        <p style="font-size: 37px">Espaço Parametrizado</p>
                        <img style="border: none" data-src="images/hough_param_02.png">
                    </div>
                </section>

                <section data-transition="none">
                    <div style="float: left; width: 50%">
                        <p style="font-size: 37px">Plano da Imagem</p>
                        <img style="border: none" data-src="images/original_lines.jpg">
                    </div>

                    <div class="fragment" style="float: left; width: 50%">
                        <p style="font-size: 37px">Espaço Parametrizado</p>
                        <img style="border: none" width="500" data-src="images/hough_inverted.jpg">
                    </div>
                </section>

                <section data-transition="none">
                    <p>A implementação da transformada de Hough para detecção de retas pode ser encontrada em:</p>

                    <a href="https://github.com/luisrpp/image_processing" target="_blank">https://github.com/luisrpp/image_processing</a>
                </section>

                <section data-transition="none">
                    <h1><font color="#0af">DEMO</font></h1>
                </section>

                <section data-transition="none" data-background="images/obrigado.png">
                </section>
            </div>
        </div>

        <script src="lib/js/head.min.js"></script>
        <script src="js/reveal.js"></script>

        <script>
            // More info https://github.com/hakimel/reveal.js#configuration
            Reveal.initialize({
                controls: true,
                progress: true,
                history: true,
                center: true,

                transition: 'slide', // none/fade/slide/convex/concave/zoom

                math: {
                    mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
                    config: 'TeX-AMS_HTML-full'  // See http://docs.mathjax.org/en/latest/config-files.html
                },

                // More info https://github.com/hakimel/reveal.js#dependencies
                dependencies: [
                    { src: 'lib/js/classList.js', condition: function() { return !document.body.classList; } },
                    { src: 'plugin/markdown/marked.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
                    { src: 'plugin/markdown/markdown.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
                    { src: 'plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },
                    { src: 'plugin/zoom-js/zoom.js', async: true },
                    { src: 'plugin/notes/notes.js', async: true },
                    { src: 'plugin/math/math.js', async: true }
                ]
            });
        </script>
    </body>
 </html>
